# Userguide: https://i3wm.org/docs/userguide.html

set $mod Mod4

# Font for window titles and the status bar
# Can be overridden in the bar {} block
font pango:monospace, FontAwesome 12

# Use Mouse+$mod to drag floating windows around
floating_modifier $mod

set $wsDev     "1:"
set $wsWeb     "2:"
set $ws3       "3:3"
set $ws4       "4:4"
set $ws5       "5:5"
set $ws6       "6:6"
set $ws7       "7:7"
set $wsSpotify "8:"
set $wsMail    "9:"
set $ws10      "10:10"

set $exec_noid exec --no-startup-id
set $i3msg     exec --no-startup-id i3-msg

# i3-gaps
for_window [class="^.*"] border pixel 2
gaps inner 15
gaps outer 15
workspace 2 gaps inner 0
workspace 2 gaps outer 0


# Switch workspace
bindsym $mod+1 workspace $wsDev
bindsym $mod+2 workspace $wsWeb
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $wsSpotify
bindsym $mod+9 workspace $wsMail
bindsym $mod+0 workspace $ws10

# Switch workspace with keypad
bindsym $mod+Mod2+KP_1 workspace $wsDev
bindsym $mod+Mod2+KP_2 workspace $wsWeb
bindsym $mod+Mod2+KP_3 workspace $ws3
bindsym $mod+Mod2+KP_4 workspace $ws4
bindsym $mod+Mod2+KP_5 workspace $ws5
bindsym $mod+Mod2+KP_6 workspace $ws6
bindsym $mod+Mod2+KP_7 workspace $ws7
bindsym $mod+Mod2+KP_8 workspace $wsSpotify
bindsym $mod+Mod2+KP_9 workspace $wsMail
bindsym $mod+Mod2+KP_0 workspace $ws10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $wsDev;     workspace $wsDev
bindsym $mod+Shift+2 move container to workspace $wsWeb;     workspace $wsWeb
bindsym $mod+Shift+3 move container to workspace $ws3;       workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4;       workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5;       workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6;       workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7;       workspace $ws7
bindsym $mod+Shift+8 move container to workspace $wsSpotify; workspace $wsSpotify
bindsym $mod+Shift+9 move container to workspace $wsMail;    workspace $wsMail
bindsym $mod+Shift+0 move container to workspace $ws10;      workspace $ws10

# Ranger terminal control
for_window [title="^ranger$"] move to scratchpad
bindsym $mod+n [title="^ranger$"] scratchpad show, resize set 1640 800, move position center

for_window [instance="^FloatingTerm$"] move to scratchpad
bindsym $mod+t $exec_noid /home/nelson/.config/i3/scripts/floatingTerm

# Change the focused window
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Move the focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Split horizontally
bindsym $mod+b split h
# Split vertically
bindsym $mod+v split v

# Toggle tiling/floating
bindsym $mod+Shift+space floating toggle

# Toggle fullscreen for the focused container
bindsym $mod+f fullscreen toggle

# Change the focused container layout
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Change focus between tiling/floating windows
bindsym $mod+space focus mode_toggle

# Focus the parent container
bindsym $mod+a focus parent

# Focus the child container
bindsym $mod+z focus child

# Kill the focused window
bindsym $mod+Shift+c kill

# Open a terminal
bindsym $mod+Return exec urxvt

# Open chrome
bindsym $mod+backslash exec google-chrome

# Start dmenu
bindsym $mod+p $exec_noid i3-dmenu-desktop

# Reload the config file
bindsym $mod+q reload
# Restart i3
bindsym $mod+Shift+q restart

# Multimedia bindings
set $volumeCmd amixer -qc 0 -D pulse set Master
set $volumeChanged play /usr/share/sounds/freedesktop/stereo/audio-volume-change.oga
set $audioCmd dbus-send --type=method_call --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player

bindsym XF86AudioRaiseVolume $exec_noid $volumeCmd 10%+ unmute && $volumeChanged
bindsym XF86AudioLowerVolume $exec_noid $volumeCmd 10%- unmute && $volumeChanged
bindsym XF86AudioMute $exec_noid $volumeCmd toggle
bindsym XF86AudioPlay $exec_noid $audioCmd.PlayPause
bindsym $mod+bracketright $exec_noid $audioCmd.Next
bindsym $mod+bracketleft $exec_noid $audioCmd.Previous
set $lockscreen /home/nelson/.config/i3/assets/lockscreen/lockscreen.png
bindsym $mod+Shift+z $exec_noid i3lock -eni $lockscreen

# Brightness keys
bindsym XF86MonBrightnessUp $exec_noid xbacklight -inc 10
bindsym XF86MonBrightnessDown $exec_noid xbacklight -dec 10


# Resize the focused window
bindsym $mod+r mode "resize"
mode "resize" {
    # h: Decrease width
    # j: Decrease height
    # k: Increase height
    # l: Increase width
    bindsym h resize shrink width  5 px or 5 ppt
    bindsym j resize shrink height 5 px or 5 ppt
    bindsym k resize grow   height 5 px or 5 ppt
    bindsym l resize grow   width  5 px or 5 ppt

    # Enter or Escape exits resize mode
    bindsym Return mode "default"
    bindsym Escape mode "default"
}


set $mode_confirm_logout Logout now? [y]es [n]o
mode "$mode_confirm_logout" {
    bindsym y      $exec_noid i3-msg exit
    bindsym Return $exec_noid i3-msg exit
    bindsym n      mode default
    bindsym Escape mode default
}


set $mode_confirm_hibernate Hibernate now? [y]es [n]o
mode "$mode_confirm_hibernate" {
    bindsym y      $exec_noid systemctl suspend; mode default
    bindsym Return $exec_noid systemctl suspend; mode default
    bindsym n      mode default
    bindsym Escape mode default
}


set $mode_confirm_shutdown Shutdown now? [y]es [n]o
mode "$mode_confirm_shutdown" {
    bindsym y      $exec_noid shutdown now
    bindsym Return $exec_noid shutdown now
    bindsym n      mode default
    bindsym Escape mode default
}


set $mode_confirm_reboot Reboot now? [y]es [n]o
mode "$mode_confirm_reboot" {
    bindsym y      $exec_noid reboot
    bindsym Return $exec_noid reboot
    bindsym n      mode default
    bindsym Escape mode default
}


set $mode_system System: [l]ogout [h]ibernate [s]hutdown [r]eboot
bindsym $mod+Control+l mode "$mode_system"
mode "$mode_system" {
    bindsym l mode "$mode_confirm_logout"
    bindsym h mode "$mode_confirm_hibernate"
    bindsym s mode "$mode_confirm_shutdown"
    bindsym r mode "$mode_confirm_reboot"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}


bindsym $mod+Control+m mode "Move"
mode "Move" {
    bindsym h move left
    bindsym j move down
    bindsym k move up
    bindsym l move right
    bindsym Shift+h move left 64px
    bindsym Shift+j move down 64px
    bindsym Shift+k move up 64px
    bindsym Shift+l move right 64px
    bindsym Return mode default
    bindsym Escape mode default
}


# Default workspaces for programs
for_window [class="^Nm-connection-editor$"] floating enable
for_window [class="^VirtualBox Machine$"] move to workspace $ws3


# i3blocks config
bar {
    status_command i3blocks -c ~/.config/i3/i3blocks.conf
    strip_workspace_numbers yes
    colors {
        background #232f34  # Bar background color
        statusline #eceff1  # Text color
        separator  #00acc1  # Status separator color

        # Color class       Border   BG       Text
        focused_workspace   #0098a7  #006064  #ffffff
        active_workspace    #00adc1  #00848f  #ffffff
        inactive_workspace  #6a6377  #282334  #ffffff
        urgent_workspace    #c8615c  #ac1714  #ffffff
    }
}


# Layouts
$i3msg 'workspace $wsDev; append_layout ~/.config/i3/layouts/wsDev.json'
$i3msg 'workspace $wsWeb; append_layout ~/.config/i3/layouts/wsWeb.json'
$i3msg 'workspace $wsMail; append_layout ~/.config/i3/layouts/wsMail.json'

# Layouts won't work with Spotify
for_window [class="Spotify"] move to workspace $wsSpotify


# Start xautolock, config in ~/.Xresource
$exec_noid xautolock -noclose -notify 10 -notifier /home/nelson/.config/i3/scripts/dimmer -time 10 -locker 'i3lock -eni /home/nelson/.config/i3/assets/lockscreen/lockscreen.png'
$exec_noid xautolock -noclose -time 12 -locker 'systemctl suspend'

# Set the background
exec_always --no-startup-id nitrogen --set-zoom-fill --random ~/.config/i3/assets/backgrounds

# Start the GNOME keyring for Chrome and other programs
exec gnome-keyring-daemon --start

# Start the compositor
exec compton

# Start NetworkManager
$exec_noid nm-applet

# Start in the dev workspace
$i3msg 'workspace $wsDev'

# Startup programs
$exec_noid xbacklight -set 20
$exec_noid xrdb -merge ~/.Xresources
$exec_noid dunst -config ~/.dunstrc
exec urxvt
exec spotify
exec urxvt -e ranger
exec urxvt -name FloatingTerm
exec google-chrome
exec /usr/bin/thunderbird
